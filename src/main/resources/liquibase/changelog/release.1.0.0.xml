<?xml version="1.0" encoding="utf-8"?>
<!--
  ~ Copyright (c) 2017. Shanghai Zhenhui Information Technology Co,. ltd.
  ~ All rights are reserved.
  -->

<databaseChangeLog
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

    <property name="now" value="now()" dbms="mysql,h2"/>
    <property name="autoIncrement" value="true" dbms="mysql,h2,postgresql,oracle"/>
    <changeSet author="liang.liu" id="201709131902001">
        <createTable tableName="role" remarks="角色表">
            <column name="id" type="bigint" remarks="角色id"/>
            <column name="role" type="varchar(30)" remarks="角色描述"/>
            <column name="user_id" type="bigint" remarks="用户id"/>
        </createTable>
    </changeSet>
    <changeSet id="201709131916001" author="liang.liu">
        <createTable tableName="user" remarks="用户表">
            <column name="id" type="bigint" remarks="id">
                <constraints primaryKey="true"/>
            </column>
            <column name="user_name" type="varchar(30)" remarks="用户名">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="password" type="varchar(30)" remarks="密码">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="201709141105001" author="liang.liu">
        <createTable tableName="user_role" remarks="用户-角色关系表">
            <column name="id" type="bigint" remarks="用户角色关系表id" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="user_id" type="bigint" remarks="用户id">
                <constraints nullable="false"/>
            </column>
            <column name="role_id" type="bigint" remarks="角色id">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <!--<changeSet id="2222" author="liuliang">-->
        <!--<modifyDataType tableName="user_role" columnName="id" newDataType="int"></modifyDataType>-->
    <!--</changeSet>-->
    <changeSet id="201711101025001" author="liang.liu">
        <addColumn tableName="user">
            <column name="mail" type="varchar(50)" remarks="邮箱"/>
            <column name="phone" type="int" remarks="电话"/>
        </addColumn>
    </changeSet>


    <changeSet id="201711161114001" author="liang.liu">
        <createTable tableName="exp_form_assign_company" remarks="表单分配公司">
            <column name="id" type="bigint" remarks="id">
                <constraints primaryKey="true"/>
            </column>
            <column name="company_id" type="bigint" remarks="公司id">
                <constraints nullable="false"/>
            </column>
            <column name="form_oid" type="varchar(36)" remarks="表单oid">
                <constraints nullable="false"/>
            </column>
            <column name="version_number" type="int" remarks="版本号">
                <constraints nullable="false"/>
            </column>
            <column name="is_enabled" type="boolean" remarks="启用标志">
                <constraints nullable="false"/>
            </column>
            <column name="is_deleted" type="boolean" remarks="删除标志">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp" defaultValue="${now}" remarks="创建日期">
                <constraints nullable="false"/>
            </column>
            <column name="created_by" type="bigint" remarks="创建用户ID">
                <constraints nullable="false"/>
            </column>
            <column name="last_updated_date" type="timestamp" defaultValue="${now}" remarks="最后更新日期">
                <constraints nullable="false"/>
            </column>
            <column name="last_updated_by" type="bigint" remarks="最后更新用户ID">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="201712171922001" author="liang.liu">
        <sqlFile path="classpath:liquibase/data/release1.0.0/init.sql" encoding="UTF-8"/>
    </changeSet>
    <changeSet id="201712181313001" author="liang.liu">
        <addColumn tableName="shopcar">
            <column name="number" type="int" remarks="商品数量"/>
            <column name="total_amount" type="double" remarks="商品总金额"/>
        </addColumn>
    </changeSet>
    
    <changeSet id="201712181941001" author="liang.liu">
        <renameColumn tableName="shopcar" oldColumnName="total_amount" newColumnName="goodprice" columnDataType="double" remarks="物品    总金额"/>
    </changeSet>
    <changeSet id="20171221001" author="liang.liu">
        <modifyDataType tableName="writes" columnName="createTime" newDataType="timestamp"/>
    </changeSet>

</databaseChangeLog>